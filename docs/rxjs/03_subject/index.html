<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="概述 # RxJS Subject 是一种特殊类型的 Observable，它允许将值多播给多个观察者，所以 Subject 是多播的，这意味着 Subject 确保每个观察者之间共享 Observable 的值。
而普通的 Observable 是单播的，它会为每一个观察者创建一次新的、独立的执行。当观察者进行订阅时，该可观察对象会连上一个事件处理器，并且向那个观察者发送一些值。当第二个观察者订阅时，这个可观察对象就会连上一个新的事件处理器，并独立执行一次，把这些值发送给第二个可观察对象。
在 RxJS 中有四种 Subject 分别是：Subject，BehaviorSubject，AsyncSubject，ReplaySubject；这四种 Subject 都是特殊的 Observable。
Subject 既是 Observable 也是 Observer。
Subject # Subject 其实是观察者模式的实现，所以当观察者订阅 Subject 对象时，它会把订阅者添加到观察者列表中，每当有接收到新值时，它就会遍历观察者列表，依次调用观察者内部的 next 方法，把值一一送出。
import { Subject } from 'rxjs'; const subject$ = new Subject<number>(); subject$.next(1); subject$.subscribe({ next: (v) => console.log(`observerA: ${v}`), }); subject$.next(2); subject$.subscribe({ next: (v) => console.log(`observerB: ${v}`), }); subject$.next(3); // Output: // observerA: 2 // observerA: 3 // observerB: 3 创建了一个 Subject 发出了一个值 1，但由于此时并没有订阅者，所以这个值不会被订阅到 创建了 observerA 又发出一个值 2，这时候 observerA 会接收到这个值 又创建一个 observerB 最后发出一个值 3，这时候已经订阅的都会接收到这个值 BehaviorSubject # BehaviorSubject，它有一个当前值的概念。它保存了发送给消费者的最新值，当有新的观察者订阅时，会立即从 BehaviorSubject 那接收到最后发出的值。"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Subject"><meta property="og:description" content="概述 # RxJS Subject 是一种特殊类型的 Observable，它允许将值多播给多个观察者，所以 Subject 是多播的，这意味着 Subject 确保每个观察者之间共享 Observable 的值。
而普通的 Observable 是单播的，它会为每一个观察者创建一次新的、独立的执行。当观察者进行订阅时，该可观察对象会连上一个事件处理器，并且向那个观察者发送一些值。当第二个观察者订阅时，这个可观察对象就会连上一个新的事件处理器，并独立执行一次，把这些值发送给第二个可观察对象。
在 RxJS 中有四种 Subject 分别是：Subject，BehaviorSubject，AsyncSubject，ReplaySubject；这四种 Subject 都是特殊的 Observable。
Subject 既是 Observable 也是 Observer。
Subject # Subject 其实是观察者模式的实现，所以当观察者订阅 Subject 对象时，它会把订阅者添加到观察者列表中，每当有接收到新值时，它就会遍历观察者列表，依次调用观察者内部的 next 方法，把值一一送出。
import { Subject } from 'rxjs'; const subject$ = new Subject<number>(); subject$.next(1); subject$.subscribe({ next: (v) => console.log(`observerA: ${v}`), }); subject$.next(2); subject$.subscribe({ next: (v) => console.log(`observerB: ${v}`), }); subject$.next(3); // Output: // observerA: 2 // observerA: 3 // observerB: 3 创建了一个 Subject 发出了一个值 1，但由于此时并没有订阅者，所以这个值不会被订阅到 创建了 observerA 又发出一个值 2，这时候 observerA 会接收到这个值 又创建一个 observerB 最后发出一个值 3，这时候已经订阅的都会接收到这个值 BehaviorSubject # BehaviorSubject，它有一个当前值的概念。它保存了发送给消费者的最新值，当有新的观察者订阅时，会立即从 BehaviorSubject 那接收到最后发出的值。"><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/frontend-learn/docs/rxjs/03_subject/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-12-08T16:28:03+08:00"><title>Subject | Frontend Learning</title><link rel=manifest href=/frontend-learn/manifest.json><link rel=icon href=/frontend-learn/favicon.png type=image/x-icon><link rel=stylesheet href=/frontend-learn/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/frontend-learn/flexsearch.min.js></script>
<script defer src=/frontend-learn/en.search.min.93283c8dbc44de279a5837e797c87304f778453a08cf3aff08ab480fa757dac6.js integrity="sha256-kyg8jbxE3ieaWDfnl8hzBPd4RToIzzr/CKtID6dX2sY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/frontend-learn/><span>Frontend Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/frontend-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><a href=/frontend-learn/docs/html/>HTML 和 CSS</a><ul><li><a href=/frontend-learn/docs/html/01_tags/>HTML 标签</a></li><li><a href=/frontend-learn/docs/html/02_css/>CSS 常用属性</a></li><li><a href=/frontend-learn/docs/html/03_layout/>布局与定位</a></li><li><a href=/frontend-learn/docs/html/04_animation/>过渡和动画</a></li><li><a href=/frontend-learn/docs/html/05_other/>其他属性</a></li><li><a href=/frontend-learn/docs/html/06_selector/>CSS 选择器</a></li><li><a href=/frontend-learn/docs/html/07_responsive/>响应式</a></li><li><a href=/frontend-learn/docs/html/08_svg/>SVG</a></li><li><a href=/frontend-learn/docs/html/09_chrome/>Chrome 开发者工具</a></li></ul></li><li><span>RxJS</span><ul><li><a href=/frontend-learn/docs/rxjs/01_overview/>概念</a></li><li><a href=/frontend-learn/docs/rxjs/02_operators/>操作符</a></li><li><a href=/frontend-learn/docs/rxjs/03_subject/ class=active>Subject</a></li><li><a href=/frontend-learn/docs/rxjs/04_practice/>实践</a></li></ul></li><li><span>Angular</span><ul><li><a href=/frontend-learn/docs/angular/01_overview/>概述</a></li><li><a href=/frontend-learn/docs/angular/02_component/>组件模板</a></li><li><a href=/frontend-learn/docs/angular/03_communication/>组件通讯</a></li><li><a href=/frontend-learn/docs/angular/04_lifecycle/>组件生命周期</a></li><li><a href=/frontend-learn/docs/angular/05_directive/>指令</a></li><li><a href=/frontend-learn/docs/angular/06_pipe/>管道</a></li><li><a href=/frontend-learn/docs/angular/07_di/>依赖注入</a></li><li><a href=/frontend-learn/docs/angular/08_service/>服务</a></li><li><a href=/frontend-learn/docs/angular/09_form/>表单</a></li><li><a href=/frontend-learn/docs/angular/10_custom_form/>自定义表单控件</a></li><li><a href=/frontend-learn/docs/angular/11_router/>路由</a></li><li><a href=/frontend-learn/docs/angular/12_http/>HttpClient</a></li><li><a href=/frontend-learn/docs/angular/13_other/>其他</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/frontend-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Subject</strong>
<label for=toc-control><img src=/frontend-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#概述>概述</a></li><li><a href=#subject>Subject</a><ul><li><a href=#behaviorsubject>BehaviorSubject</a></li><li><a href=#replaysubject>ReplaySubject</a></li><li><a href=#asyncsubject>AsyncSubject</a></li><li><a href=#void-subject>Void subject</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=概述>概述
<a class=anchor href=#%e6%a6%82%e8%bf%b0>#</a></h1><p>RxJS <code>Subject</code> 是一种特殊类型的 <code>Observable</code>，它允许将值多播给多个观察者，所以 <code>Subject</code> 是多播的，这意味着 <code>Subject</code> 确保每个观察者之间共享 <code>Observable</code> 的值。</p><p><strong>而普通的 <code>Observable</code> 是单播的，它会为每一个观察者创建一次新的、独立的执行。当观察者进行订阅时，该可观察对象会连上一个事件处理器，并且向那个观察者发送一些值。当第二个观察者订阅时，这个可观察对象就会连上一个新的事件处理器，并独立执行一次，把这些值发送给第二个可观察对象</strong>。</p><p>在 RxJS 中有四种 Subject 分别是：<code>Subject</code>，<code>BehaviorSubject</code>，<code>AsyncSubject</code>，<code>ReplaySubject</code>；这四种 Subject 都是特殊的 <code>Observable</code>。</p><p><code>Subject</code> 既是 <code>Observable</code> 也是 <code>Observer</code>。</p><h1 id=subject>Subject
<a class=anchor href=#subject>#</a></h1><p><code>Subject</code> 其实是观察者模式的实现，所以当观察者订阅 <code>Subject</code> 对象时，它会把订阅者添加到观察者列表中，每当有接收到新值时，它就会遍历观察者列表，依次调用观察者内部的 <code>next</code> 方法，把值一一送出。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Subject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>subject$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Subject</span>&lt;<span style=color:#f92672>number</span>&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerA: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerB: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Output:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 3
</span></span></span></code></pre></div><ol><li>创建了一个 <code>Subject</code></li><li>发出了一个值 1，但由于此时并没有订阅者，所以这个值不会被订阅到</li><li>创建了 observerA</li><li>又发出一个值 2，这时候 observerA 会接收到这个值</li><li>又创建一个 observerB</li><li>最后发出一个值 3，这时候已经订阅的都会接收到这个值</li></ol><h2 id=behaviorsubject>BehaviorSubject
<a class=anchor href=#behaviorsubject>#</a></h2><p><code>BehaviorSubject</code>，它有一个<strong>当前值</strong>的概念。它保存了发送给消费者的最新值，当有新的观察者订阅时，会立即从 <code>BehaviorSubject</code> 那接收到最后发出的值。</p><p>在定义一个 <code>BehaviorSubject</code> 时需要有初始值。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>BehaviorSubject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>behavior$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>BehaviorSubject</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// 0 is the initial value
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>behavior$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerA: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>behavior$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>behavior$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerB: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>behavior$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Output:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 0
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 2
</span></span></span></code></pre></div><ol><li>创建了一个 <code>BehaviorSubject</code> 的实例 <code>behavior$</code>，初始值为 0。</li><li>然后订阅了这个 <code>behavior$</code>，由于 <code>BehaviorSubject</code> 的特点是把最新的值发布给订阅者，observerA 会得到初始值 0，所以会输出 <code>observerA: 0</code></li><li><code>behavior$</code> 发出一个新的值 1，这时候 observerA 将会收到新的值，输出 <code>observerA: 1</code></li><li>增加一个订阅者 observerB，这时候它会得到最新的值 1，所以输出 <code>observerB: 1</code>，</li><li>最后再一次发出一个新的值 2，这个时候有两个订阅者 observerA 和 observerB，它们都会接收到新的值 2，所以会输出 <code>observerA: 2</code> 和 <code>observerB: 2</code></li></ol><h2 id=replaysubject>ReplaySubject
<a class=anchor href=#replaysubject>#</a></h2><p><code>ReplaySubject</code> 有点像 <code>BehaviorSubject</code>，区别是不仅是<strong>当前值</strong>，之前的旧值也可以发送给新的订阅者。<code>ReplaySubject</code> 会记录多个值，并重放给新的订阅者。</p><p>它的第一个参数 <code>bufferSize</code> 指定了缓存的大小，默认为 <code>Infinity</code>，即缓存所有发出的值。还可以向其传递第二个参数 <code>windowTime</code>，指定缓存的时间限制，默认为 <code>Infinity</code>，即不限制值的失效时间。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ReplaySubject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>replay$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ReplaySubject</span>(<span style=color:#ae81ff>2</span>); <span style=color:#75715e>// buffer 2 values for new subscribers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerA: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerB: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Output:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 4
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 4
</span></span></span></code></pre></div><ol><li>创建了一个 <code>ReplaySubject</code> 的实例 <code>replay$</code>，并设置缓存为 2.</li><li>创建了一个订阅者 observerA</li><li>调用三次的 next 方法，把值发布给订阅者。这时订阅者 observerA 会输出三次</li><li>创建一个新的订阅者 observerB，由于 <code>ReplaySubject</code> 缓存了两个值，因此它将直接向订阅者 observerB 发出这两个值，订阅者 observerB 打印这两个值。</li><li>发出另外一个值 4，这时候 observerA 和 observerB 都接收到值的改变，分别打印这个值。</li></ol><p>指定一个以毫秒为单位的窗口时间，示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ReplaySubject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>replay$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ReplaySubject</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>100</span> <span style=color:#75715e>/* windowTime 100ms */</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerA: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>setInterval</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>), <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setTimeout</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>replay$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerB: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Output:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 0
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 2
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 4
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 4
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 5
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 5
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><ol><li>创建 <code>ReplaySubject</code>并设置缓存为 2，缓存时间不超过 100ms</li><li>创建一个 observerA</li><li>每 200ms 发出一个新的值。observerA 会接收到发出的所有值</li><li>创建一个 observerB，由于是在 1000ms 后进行订阅。这意味着在开始订阅之前，<code>replay$</code> 已经发出了 5 个值。在创建 <code>ReplaySubject</code> 时，指定最多存储 2 个值，并且不能超过 100ms。这意味着在 1000ms 后，observerB 开始订阅时，由于 <code>replay$</code> 是 200ms 发出一个值，因此 observerB 只会接收到 1 个值。</li></ol><h2 id=asyncsubject>AsyncSubject
<a class=anchor href=#asyncsubject>#</a></h2><p>只有当 Observable 执行完成时(执行 <code>complete()</code>)，它才会将执行的最后一个值发送给观察者。 类似 <code>last()</code> 操作符。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AsyncSubject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>AsyncSubject</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerA: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`observerB: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>v</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span><span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>complete</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Logs:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerA: 3
</span></span></span><span style=display:flex><span><span style=color:#75715e>// observerB: 3
</span></span></span></code></pre></div><ol><li>创建 <code>AsyncSubject</code> 的实例</li><li>创建一个 observerA</li><li><code>async$</code> 发出 2 个值，但是 observerA 不会有输出。</li><li>创建一个 observerB</li><li>发出新的值，但是 observerA 和 observerB 都不会有输出。</li><li>执行 <code>complate</code> 完成，这时候将最后一个值发送给所有订阅者</li></ol><h2 id=void-subject>Void subject
<a class=anchor href=#void-subject>#</a></h2><p>有时，subject 的值并不重要，重要的是有一个事件被触发了。</p><p>可以声明一个 <code>void subject</code>，表示这个值是不相关的。只有事件本身才是重要的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Subject</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>subject</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Subject</span>(); <span style=color:#75715e>// Shorthand for Subject&lt;void&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subject</span>.<span style=color:#a6e22e>subscribe</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>next</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;One second has passed&#39;</span>),
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setTimeout</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>subject</span>.<span style=color:#a6e22e>next</span>(), <span style=color:#ae81ff>1000</span>);
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/commit/3794de90b5da39af1a7e27a61a4b2da240d72900 title='Last modified by PengQi Shi | December 8, 2024' target=_blank rel=noopener><img src=/frontend-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 8, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/edit/master/content/docs/rxjs/03_subject.md target=_blank rel=noopener><img src=/frontend-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#概述>概述</a></li><li><a href=#subject>Subject</a><ul><li><a href=#behaviorsubject>BehaviorSubject</a></li><li><a href=#replaysubject>ReplaySubject</a></li><li><a href=#asyncsubject>AsyncSubject</a></li><li><a href=#void-subject>Void subject</a></li></ul></li></ul></nav></div></aside></main></body></html>