<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="概念 # RxJS：Think of RxJS as Lodash for events。也就是说，RxJS 是一个类似 lodash 的工具库，不过处理的对象是 Events。这里的 Events，可以称之为流。
什么是流？例如，代码中每秒会输出一个数据，或者用户每一次对元素的点击，就像是在时间这个维度上，产生了一个数据集。这个数据集不像数组那样，它不是一开始都存在的，而是随着时间的流逝，一个一个数据被输出出来。这种异步行为产生的数据，就可以被称之为一个流，在 Rxjs 中，称之为 Observalbe（本质其实就是一个数据集合，只是这些数据不一定是一开始就设定好的，而是随着时间而不断产生的）。而 Rxjs，就是为了处理这种流而产生的工具，比如流与流的合并，流的截断，延迟，消抖等等操作。
import {interval, map} from 'rxjs'; const sub = interval(1000).pipe( map(second => second + 's') ).subscribe(res => { console.log(res); }); // Output: // 0s // 2s // 3s // 4s // 5s // ... 利用 interval 返回一个 Observable 流，每 1 秒产生一个数据，然后交给 map 操作符将内容进行转换，最后交过观察者打印结果。
Observable 的核心 # 创建 # import { Observable } from 'rxjs'; const observable = new Observable(function subscribe(subscriber) { const timer = setInterval(() => { // 可以多次调用 next 方法向外发送数据 subscriber."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="概念"><meta property="og:description" content="概念 # RxJS：Think of RxJS as Lodash for events。也就是说，RxJS 是一个类似 lodash 的工具库，不过处理的对象是 Events。这里的 Events，可以称之为流。
什么是流？例如，代码中每秒会输出一个数据，或者用户每一次对元素的点击，就像是在时间这个维度上，产生了一个数据集。这个数据集不像数组那样，它不是一开始都存在的，而是随着时间的流逝，一个一个数据被输出出来。这种异步行为产生的数据，就可以被称之为一个流，在 Rxjs 中，称之为 Observalbe（本质其实就是一个数据集合，只是这些数据不一定是一开始就设定好的，而是随着时间而不断产生的）。而 Rxjs，就是为了处理这种流而产生的工具，比如流与流的合并，流的截断，延迟，消抖等等操作。
import {interval, map} from 'rxjs'; const sub = interval(1000).pipe( map(second => second + 's') ).subscribe(res => { console.log(res); }); // Output: // 0s // 2s // 3s // 4s // 5s // ... 利用 interval 返回一个 Observable 流，每 1 秒产生一个数据，然后交给 map 操作符将内容进行转换，最后交过观察者打印结果。
Observable 的核心 # 创建 # import { Observable } from 'rxjs'; const observable = new Observable(function subscribe(subscriber) { const timer = setInterval(() => { // 可以多次调用 next 方法向外发送数据 subscriber."><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/frontend-learn/docs/rxjs/01_overview/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-12-08T16:28:03+08:00"><title>概念 | Frontend Learning</title><link rel=manifest href=/frontend-learn/manifest.json><link rel=icon href=/frontend-learn/favicon.png type=image/x-icon><link rel=stylesheet href=/frontend-learn/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/frontend-learn/flexsearch.min.js></script>
<script defer src=/frontend-learn/en.search.min.e951707b992b289992b28d1d6454153d6dd8700a1487ceacb3f12740bee9c570.js integrity="sha256-6VFwe5krKJmSso0dZFQVPW3YcAoUh86ss/EnQL7pxXA=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/frontend-learn/><span>Frontend Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/frontend-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><a href=/frontend-learn/docs/html/>HTML 和 CSS</a><ul><li><a href=/frontend-learn/docs/html/01_tags/>HTML 标签</a></li><li><a href=/frontend-learn/docs/html/02_css/>CSS 常用属性</a></li><li><a href=/frontend-learn/docs/html/03_layout/>布局与定位</a></li><li><a href=/frontend-learn/docs/html/04_animation/>过渡和动画</a></li><li><a href=/frontend-learn/docs/html/05_other/>其他属性</a></li><li><a href=/frontend-learn/docs/html/06_selector/>CSS 选择器</a></li><li><a href=/frontend-learn/docs/html/07_responsive/>响应式</a></li><li><a href=/frontend-learn/docs/html/08_svg/>SVG</a></li><li><a href=/frontend-learn/docs/html/09_chrome/>Chrome 开发者工具</a></li></ul></li><li><span>RxJS</span><ul><li><a href=/frontend-learn/docs/rxjs/01_overview/ class=active>概念</a></li><li><a href=/frontend-learn/docs/rxjs/02_operators/>操作符</a></li><li><a href=/frontend-learn/docs/rxjs/03_subject/>Subject</a></li><li><a href=/frontend-learn/docs/rxjs/04_practice/>实践</a></li></ul></li><li><span>Angular</span><ul><li><a href=/frontend-learn/docs/angular/01_overview/>概述</a></li><li><a href=/frontend-learn/docs/angular/02_component/>组件模板</a></li><li><a href=/frontend-learn/docs/angular/03_communication/>组件通讯</a></li><li><a href=/frontend-learn/docs/angular/04_lifecycle/>组件生命周期</a></li><li><a href=/frontend-learn/docs/angular/05_directive/>指令</a></li><li><a href=/frontend-learn/docs/angular/06_pipe/>管道</a></li><li><a href=/frontend-learn/docs/angular/07_di/>依赖注入</a></li><li><a href=/frontend-learn/docs/angular/08_service/>服务</a></li><li><a href=/frontend-learn/docs/angular/09_form/>表单</a></li><li><a href=/frontend-learn/docs/angular/10_custom_form/>自定义表单控件</a></li><li><a href=/frontend-learn/docs/angular/11_router/>路由</a></li><li><a href=/frontend-learn/docs/angular/12_http/>HttpClient</a></li><li><a href=/frontend-learn/docs/angular/13_other/>Other</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/frontend-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>概念</strong>
<label for=toc-control><img src=/frontend-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#概念>概念</a></li><li><a href=#observable-的核心>Observable 的核心</a><ul><li><a href=#创建>创建</a></li><li><a href=#订阅>订阅</a></li><li><a href=#执行>执行</a></li><li><a href=#清理>清理</a></li><li><a href=#可观察对象的命名约定>可观察对象的命名约定</a></li></ul></li><li><a href=#observer>Observer</a></li><li><a href=#subscription>Subscription</a></li></ul></nav></aside></header><article class=markdown><h1 id=概念>概念
<a class=anchor href=#%e6%a6%82%e5%bf%b5>#</a></h1><p>RxJS：Think of RxJS as Lodash for events。也就是说，RxJS 是一个类似 lodash 的工具库，不过处理的对象是 Events。这里的 Events，可以称之为<strong>流</strong>。</p><p>什么是流？例如，代码中每秒会输出一个数据，或者用户每一次对元素的点击，就像是在时间这个维度上，产生了一个数据集。这个数据集不像数组那样，它不是一开始都存在的，而是随着时间的流逝，一个一个数据被输出出来。这种异步行为产生的数据，就可以被称之为一个<strong>流</strong>，在 Rxjs 中，称之为 <code>Observalbe</code>（本质其实就是一个数据集合，只是这些数据不一定是一开始就设定好的，而是随着时间而不断产生的）。而 Rxjs，就是为了处理这种流而产生的工具，比如流与流的合并，流的截断，延迟，消抖等等操作。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> {<span style=color:#a6e22e>interval</span>, <span style=color:#a6e22e>map</span>} <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sub</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interval</span>(<span style=color:#ae81ff>1000</span>).<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>second</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>second</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;s&#39;</span>)
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>res</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>res</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Output:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 0s
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 2s
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 3s
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 4s
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 5s
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><p>利用 <code>interval</code> 返回一个 <code>Observable</code> 流，每 1 秒产生一个数据，然后交给 <code>map</code> 操作符将内容进行转换，最后交过观察者打印结果。</p><h1 id=observable-的核心>Observable 的核心
<a class=anchor href=#observable-%e7%9a%84%e6%a0%b8%e5%bf%83>#</a></h1><h2 id=创建>创建
<a class=anchor href=#%e5%88%9b%e5%bb%ba>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observable</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Observable</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>subscriber</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>timer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setInterval</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 可以多次调用 next 方法向外发送数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#e6db74>&#39;hi&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#e6db74>&#39;hello&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 当所有数据发送完成以后，可以调用 complete 方法终止数据发送
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>complete</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>clearInterval</span>(<span style=color:#a6e22e>timer</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>通常会使用创建操作符, <code>of</code>、<code>from</code>、<code>interval</code> 等来创建。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#66d9ef>of</span>, <span style=color:#66d9ef>from</span>, <span style=color:#a6e22e>fromEvent</span>, <span style=color:#a6e22e>fromPromise</span>, <span style=color:#a6e22e>bindCallback</span>, <span style=color:#a6e22e>bindNodeCallback</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 将一个或多个值转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>of</span>(<span style=color:#e6db74>&#39;foo&#39;</span>, <span style=color:#e6db74>&#39;bar&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将数组转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>from</span>([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将事件转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fromEvent</span>(document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;button&#39;</span>), <span style=color:#e6db74>&#39;click&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将 Promise 转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fromPromise</span>(<span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/users&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将回调函数 (最后一个参数是回调函数，比如下面的 cb) 转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e>// fs.exists = (path, cb(exists))
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>exists</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bindCallback</span>(<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>exists</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>exists</span>(<span style=color:#e6db74>&#39;file.txt&#39;</span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>exists</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Does file exist?&#39;</span>, <span style=color:#a6e22e>exists</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将回调函数(最后一个参数得是回调函数，比如下面的 cb) 转为 Observable
</span></span></span><span style=display:flex><span><span style=color:#75715e>// fs.rename = (pathA, pathB, cb(err, result))
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rename</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>bindNodeCallback</span>(<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>rename</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>rename</span>(<span style=color:#e6db74>&#39;file.txt&#39;</span>, <span style=color:#e6db74>&#39;else.txt&#39;</span>).<span style=color:#a6e22e>subscribe</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Renamed!&#39;</span>));
</span></span></code></pre></div><h2 id=订阅>订阅
<a class=anchor href=#%e8%ae%a2%e9%98%85>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#a6e22e>observable</span>.<span style=color:#a6e22e>subscribe</span>((<span style=color:#a6e22e>x</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>x</span>));
</span></span></code></pre></div><p>订阅 <code>Observable</code> 可以理解为启动这个 <code>Observable 流</code>，并提供接收数据的回调函数。</p><p><strong>同一个 <code>Observable</code> 可以被多次订阅，并且每个观察这都是独立的</strong>。每个 <code>subscribe</code> 会启动一个独立的流，并向观察者传递数据。流与流相互独立，互不干扰。</p><h2 id=执行>执行
<a class=anchor href=#%e6%89%a7%e8%a1%8c>#</a></h2><p>Observable 执行可以传递三种类型的值：</p><ul><li><code>next</code> 通知：发送一个值，比如数字、字符串、对象，等等。</li><li><code>error</code> 通知：发送一个错误或异常。</li><li><code>complete</code> 通知：不再发送任何值。</li></ul><p>在 <code>Observable</code> 执行中, 可能会发送无穷个 <code>next</code> 通知。<strong>如果发送的是 <code>error</code> 或 <code>complete</code> 通知的话，那么之后不会再发送任何通知了</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observable</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Observable</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>subscriber</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>complete</span>();
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>next</span>(<span style=color:#ae81ff>3</span>); <span style=color:#75715e>// 不会发送
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>err</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subscriber</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>err</span>); <span style=color:#75715e>// 如果捕获到异常会发送一个错误
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=清理>清理
<a class=anchor href=#%e6%b8%85%e7%90%86>#</a></h2><p>因为 <code>Observable</code> 执行可能会是无限的，并且观察者通常希望能在有限的时间内中止执行，它必须要一种方法来停止执行，以避免浪费计算能力或内存资源。</p><p><code>observable.subscribe</code> 会返回一个 <code>Subscription</code> 可以用来取消订阅。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#66d9ef>from</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observable</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>from</span>([<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>30</span>]);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>subscription</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>observable</span>.<span style=color:#a6e22e>subscribe</span>((<span style=color:#a6e22e>x</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>x</span>));
</span></span><span style=display:flex><span><span style=color:#75715e>// Later:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>subscription</span>.<span style=color:#a6e22e>unsubscribe</span>();
</span></span></code></pre></div><h2 id=可观察对象的命名约定>可观察对象的命名约定
<a class=anchor href=#%e5%8f%af%e8%a7%82%e5%af%9f%e5%af%b9%e8%b1%a1%e7%9a%84%e5%91%bd%e5%90%8d%e7%ba%a6%e5%ae%9a>#</a></h2><p>通常以 <code>$</code> 符号结尾。</p><h1 id=observer>Observer
<a class=anchor href=#observer>#</a></h1><p><code>Observer</code> 观察者只是一组回调函数的集合，用来消费 <code>Observable</code> 发送的数据。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observer</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>next</span>: <span style=color:#66d9ef>x</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Observer got a next value: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>err</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Observer got an error: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>err</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>complete</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Observer got a complete notification&#39;</span>),
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>observable</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>observer</span>);
</span></span></code></pre></div><h1 id=subscription>Subscription
<a class=anchor href=#subscription>#</a></h1><p><code>Subscription</code> 通常是 <code>Observable</code> 的执行。<code>Subscription</code> 有一个重要的方法，即 <code>unsubscribe</code>，用来取消 <code>Observable</code> 执行。</p><p><code>Subscription</code> 还可以合在一起：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>interval</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observable1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interval</span>(<span style=color:#ae81ff>400</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>observable2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>interval</span>(<span style=color:#ae81ff>300</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>subscription</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>observable1</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>x</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;first: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>childSubscription</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>observable2</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>x</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;second: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>x</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>subscription</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>childSubscription</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setTimeout</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// subscription 和 childSubscription 都会取消订阅
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>subscription</span>.<span style=color:#a6e22e>unsubscribe</span>();
</span></span><span style=display:flex><span>}, <span style=color:#ae81ff>1000</span>);
</span></span></code></pre></div><p><code>Subscriptions</code> 还有一个 <code>remove(otherSubscription)</code> 方法，用来撤销一个已添加的子 <code>Subscription</code>。</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/commit/3794de90b5da39af1a7e27a61a4b2da240d72900 title='Last modified by PengQi Shi | December 8, 2024' target=_blank rel=noopener><img src=/frontend-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 8, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/edit/master/content/docs/rxjs/01_overview.md target=_blank rel=noopener><img src=/frontend-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#概念>概念</a></li><li><a href=#observable-的核心>Observable 的核心</a><ul><li><a href=#创建>创建</a></li><li><a href=#订阅>订阅</a></li><li><a href=#执行>执行</a></li><li><a href=#清理>清理</a></li><li><a href=#可观察对象的命名约定>可观察对象的命名约定</a></li></ul></li><li><a href=#observer>Observer</a></li><li><a href=#subscription>Subscription</a></li></ul></nav></div></aside></main></body></html>