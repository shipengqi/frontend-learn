<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="快速上手 # 创建页面组件、Layout 组件以及 Navigation 组件，供路由使用
创建首页页面组件ng g c pages/home 创建关于我们页面组件ng g c pages/about 创建布局组件ng g c pages/layout 创建导航组件ng g c pages/navigation 创建路由规则
// app.module.ts import { Routes } from &#34;@angular/router&#34; const routes: Routes = [ { path: &#34;home&#34;, component: HomeComponent }, { path: &#34;about&#34;, component: AboutComponent } ] 引入路由模块并启动
// app.module.ts import { RouterModule, Routes } from &#34;@angular/router&#34; @NgModule({ imports: [RouterModule.forRoot(routes, { useHash: true })], }) export class AppModule {} 添加路由插座"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="路由"><meta property="og:description" content="快速上手 # 创建页面组件、Layout 组件以及 Navigation 组件，供路由使用
创建首页页面组件ng g c pages/home 创建关于我们页面组件ng g c pages/about 创建布局组件ng g c pages/layout 创建导航组件ng g c pages/navigation 创建路由规则
// app.module.ts import { Routes } from &#34;@angular/router&#34; const routes: Routes = [ { path: &#34;home&#34;, component: HomeComponent }, { path: &#34;about&#34;, component: AboutComponent } ] 引入路由模块并启动
// app.module.ts import { RouterModule, Routes } from &#34;@angular/router&#34; @NgModule({ imports: [RouterModule.forRoot(routes, { useHash: true })], }) export class AppModule {} 添加路由插座"><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/frontend-learn/docs/angular/11_router/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-12-08T20:10:16+08:00"><title>路由 | Frontend Learning</title><link rel=manifest href=/frontend-learn/manifest.json><link rel=icon href=/frontend-learn/favicon.png type=image/x-icon><link rel=stylesheet href=/frontend-learn/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/frontend-learn/flexsearch.min.js></script>
<script defer src=/frontend-learn/en.search.min.66b1f569c729b8bb9333a7fef42807ae56aed646360bd401fb7c704d82dc17f6.js integrity="sha256-ZrH1accpuLuTM6f+9CgHrlau1kY2C9QB+3xwTYLcF/Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/frontend-learn/><span>Frontend Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/frontend-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><a href=/frontend-learn/docs/html/>HTML 和 CSS</a><ul><li><a href=/frontend-learn/docs/html/01_tags/>HTML 标签</a></li><li><a href=/frontend-learn/docs/html/02_css/>CSS 常用属性</a></li><li><a href=/frontend-learn/docs/html/03_layout/>布局与定位</a></li><li><a href=/frontend-learn/docs/html/04_animation/>过渡和动画</a></li><li><a href=/frontend-learn/docs/html/05_other/>其他属性</a></li><li><a href=/frontend-learn/docs/html/06_selector/>CSS 选择器</a></li><li><a href=/frontend-learn/docs/html/07_responsive/>响应式</a></li><li><a href=/frontend-learn/docs/html/08_svg/>SVG</a></li><li><a href=/frontend-learn/docs/html/09_chrome/>Chrome 开发者工具</a></li></ul></li><li><span>RxJS</span><ul><li><a href=/frontend-learn/docs/rxjs/01_overview/>概念</a></li><li><a href=/frontend-learn/docs/rxjs/02_operators/>操作符</a></li><li><a href=/frontend-learn/docs/rxjs/03_subject/>Subject</a></li><li><a href=/frontend-learn/docs/rxjs/04_practice/>实践</a></li></ul></li><li><span>Angular</span><ul><li><a href=/frontend-learn/docs/angular/01_overview/>概述</a></li><li><a href=/frontend-learn/docs/angular/02_component/>组件模板</a></li><li><a href=/frontend-learn/docs/angular/03_communication/>组件通讯</a></li><li><a href=/frontend-learn/docs/angular/04_lifecycle/>组件生命周期</a></li><li><a href=/frontend-learn/docs/angular/05_directive/>指令</a></li><li><a href=/frontend-learn/docs/angular/06_pipe/>管道</a></li><li><a href=/frontend-learn/docs/angular/07_di/>依赖注入</a></li><li><a href=/frontend-learn/docs/angular/08_service/>服务</a></li><li><a href=/frontend-learn/docs/angular/09_form/>表单</a></li><li><a href=/frontend-learn/docs/angular/10_custom_form/>自定义表单控件</a></li><li><a href=/frontend-learn/docs/angular/11_router/ class=active>路由</a></li><li><a href=/frontend-learn/docs/angular/12_http/>HttpClient</a></li><li><a href=/frontend-learn/docs/angular/13_other/>其他</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/frontend-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>路由</strong>
<label for=toc-control><img src=/frontend-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#快速上手>快速上手</a></li><li><a href=#路由规则>路由规则</a><ul><li><a href=#重定向>重定向</a></li><li><a href=#404-页面>404 页面</a></li></ul></li><li><a href=#路由传参>路由传参</a><ul><li><a href=#查询参数>查询参数</a></li><li><a href=#动态参数>动态参数</a></li><li><a href=#配置路由数据>配置路由数据</a></li><li><a href=#snapshot>snapshot</a></li></ul></li><li><a href=#路由嵌套>路由嵌套</a></li><li><a href=#命名插座>命名插座</a></li><li><a href=#导航路由>导航路由</a></li><li><a href=#路由懒加载>路由懒加载</a><ul><li><a href=#路由懒加载的好处>路由懒加载的好处</a></li></ul></li><li><a href=#路由守卫>路由守卫</a><ul><li><a href=#canactivate>CanActivate</a></li><li><a href=#canactivatechild>CanActivateChild</a></li><li><a href=#candeactivate>CanDeactivate</a></li><li><a href=#canload>CanLoad</a></li><li><a href=#resolve>Resolve</a></li></ul></li><li><a href=#路由事件>路由事件</a><ul><li><a href=#显示加载指示器>显示加载指示器</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=快速上手>快速上手
<a class=anchor href=#%e5%bf%ab%e9%80%9f%e4%b8%8a%e6%89%8b>#</a></h1><ol><li><p>创建页面组件、Layout 组件以及 Navigation 组件，供路由使用</p><ol><li>创建<strong>首页</strong>页面组件<code>ng g c pages/home</code></li><li>创建<strong>关于我们</strong>页面组件<code>ng g c pages/about</code></li><li>创建<strong>布局</strong>组件<code>ng g c pages/layout</code></li><li>创建<strong>导航</strong>组件<code>ng g c pages/navigation</code></li></ol></li><li><p>创建路由规则</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@angular/router&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;home&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HomeComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;about&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div></li><li><p>引入路由模块并启动</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RouterModule</span>, <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@angular/router&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>, { <span style=color:#a6e22e>useHash</span>: <span style=color:#66d9ef>true</span> })],
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppModule</span> {}
</span></span></code></pre></div></li><li><p>添加路由插座</p><p><strong>路由插座 <code>&lt;router-outlet></code> 即占位组件 匹配到的路由组件将会显示在这个地方</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--  --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>router-outlet</span>&gt;&lt;/<span style=color:#f92672>router-outlet</span>&gt;
</span></span></code></pre></div></li><li><p>在导航组件中定义链接</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>routerLink</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/home&#34;</span>&gt;首页&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>routerLink</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about&#34;</span>&gt;关于我们&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div></li></ol><h1 id=路由规则>路由规则
<a class=anchor href=#%e8%b7%af%e7%94%b1%e8%a7%84%e5%88%99>#</a></h1><h2 id=重定向>重定向
<a class=anchor href=#%e9%87%8d%e5%ae%9a%e5%90%91>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;home&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HomeComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;about&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 重定向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>redirectTo</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;home&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 完全匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>pathMatch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;full&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h2 id=404-页面>404 页面
<a class=anchor href=#404-%e9%a1%b5%e9%9d%a2>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;home&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HomeComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;about&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;**&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>NotFoundComponent</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h1 id=路由传参>路由传参
<a class=anchor href=#%e8%b7%af%e7%94%b1%e4%bc%a0%e5%8f%82>#</a></h1><h2 id=查询参数>查询参数
<a class=anchor href=#%e6%9f%a5%e8%af%a2%e5%8f%82%e6%95%b0>#</a></h2><p>通过 <code>queryParams</code> 添加查询参数：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>routerLink</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about&#34;</span> <span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>queryParams</span><span style=color:#960050;background-color:#1e0010>]=&#34;{</span> <span style=color:#a6e22e>name:</span> <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#a6e22e>kitty</span><span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#960050;background-color:#1e0010>}&#34;</span>&gt;关于我们&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><p>访问 url 路径是：<code>/about?name=kitty</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ActivatedRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@angular/router&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AboutComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>ActivatedRoute</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngOnInit</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>queryParamMap</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>query</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>query</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>&#34;name&#34;</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=动态参数>动态参数
<a class=anchor href=#%e5%8a%a8%e6%80%81%e5%8f%82%e6%95%b0>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;home&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HomeComponent</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;about/:name&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p><code>about/:name</code> 中的 <code>:name</code> 就是一个动态参数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>routerLink</span><span style=color:#960050;background-color:#1e0010>]=&#34;[&#39;/</span><span style=color:#a6e22e>about</span><span style=color:#960050;background-color:#1e0010>&#39;,</span> <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#a6e22e>zhangsan</span><span style=color:#960050;background-color:#1e0010>&#39;]&#34;</span>&gt;关于我们&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><p>访问 url 路径是：<code>/about/zhangsan</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ActivatedRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@angular/router&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AboutComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>ActivatedRoute</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngOnInit</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>paramMap</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>params</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>params</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>&#34;name&#34;</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=配置路由数据>配置路由数据
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e8%b7%af%e7%94%b1%e6%95%b0%e6%8d%ae>#</a></h2><p>Angular 可以在路由配置中使用 <code>data</code> 属性来定义数据。<code>data</code> 属性接受一个对象，可以在组件中通过 <code>ActivatedRoute</code> 获取这些数据。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NgModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RouterModule</span>, <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>HomeComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./home/home.component&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AboutComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./about/about.component&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HomeComponent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Home Page&#39;</span> } <span style=color:#75715e>// 配置数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;about&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;About Us&#39;</span> } <span style=color:#75715e>// 配置数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> { }
</span></span></code></pre></div><p>通过 <code>ActivatedRoute</code> 来访问路由数据：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>OnInit</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ActivatedRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Component</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-home&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>template</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`&lt;h1&gt;{{ title }}&lt;/h1&gt;`</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HomeComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>ActivatedRoute</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngOnInit</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取路由配置中的数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>data</span>[<span style=color:#e6db74>&#39;title&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 也可以订阅数据变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>data</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>[<span style=color:#e6db74>&#39;title&#39;</span>];
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=snapshot>snapshot
<a class=anchor href=#snapshot>#</a></h2><p><code>ActivatedRoute.snapshot</code> 是一个用于获取当前路由状态的快照对象。它包含了与当前路由相关的所有信息，包括路由参数、查询参数、数据等。<code>snapshot</code> 主要用于<strong>同步</strong>获取路由信息。</p><ul><li><strong>当你需要在路由切换时读取静态的路由信息时</strong>，而不需要响应路由变化。</li><li><strong>不需要监听路由变化</strong>，而是只需要在组件初始化时获取一次路由参数和其他信息时使用。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>OnInit</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ActivatedRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Component</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-product-detail&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./product-detail.component.html&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>styleUrls</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./product-detail.component.css&#39;</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ProductDetailComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>productId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>ActivatedRoute</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngOnInit() {</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取路由参数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>productId</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>paramMap</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>&#39;id&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取查询参数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>category</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>queryParamMap</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>&#39;category&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取完整的 URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>url</span>); <span style=color:#75715e>// 返回 URL 数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;/&#39;</span>)); <span style=color:#75715e>// 返回 URL 字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>它适用于你只需要在组件加载时读取一次路由信息，并且不需要响应路由参数变化的场景。如果需要响应路由的变化（例如，路由参数的改变），则应该使用 <code>route.params</code> 或 <code>route.queryParams</code> 并订阅它们。</p><h1 id=路由嵌套>路由嵌套
<a class=anchor href=#%e8%b7%af%e7%94%b1%e5%b5%8c%e5%a5%97>#</a></h1><p>路由嵌套指的是如何定义子级路由。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;about&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>AboutComponent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;introduce&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>IntroduceComponent</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;history&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>HistoryComponent</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>下面是父级组件模板：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- about.component.html --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>app-layout</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>p</span>&gt;about works!&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>routerLink</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about/introduce&#34;</span>&gt;公司简介&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>routerLink</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/about/history&#34;</span>&gt;发展历史&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>router-outlet</span>&gt;&lt;/<span style=color:#f92672>router-outlet</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>app-layout</span>&gt;
</span></span></code></pre></div><p>父级模板中添加了 <code>&lt;router-outlet></code>，用来显示子级路由的组件。</p><h1 id=命名插座>命名插座
<a class=anchor href=#%e5%91%bd%e5%90%8d%e6%8f%92%e5%ba%a7>#</a></h1><p>命名路由插座使得在同一页面中渲染多个视图变得更加灵活，常用于复杂的布局或多个区域显示不同内容的场景。。</p><p>命名插座使用 <code>outlet</code> 属性来指定。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>   { <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>, <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>DashboardComponent</span> },
</span></span><span style=display:flex><span>   { <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;user-profile&#39;</span>, <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>UserProfileComponent</span>, <span style=color:#a6e22e>outlet</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;sidebar&#39;</span> }
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><p>模板布局：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;main-content&#34;</span>&gt;
</span></span><span style=display:flex><span>   &lt;<span style=color:#f92672>router-outlet</span>&gt;&lt;/<span style=color:#f92672>router-outlet</span>&gt; <span style=color:#75715e>&lt;!-- 默认插座显示 dashboard 或其他组件 --&gt;</span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sidebar&#34;</span>&gt;
</span></span><span style=display:flex><span>   &lt;<span style=color:#f92672>router-outlet</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sidebar&#34;</span>&gt;&lt;/<span style=color:#f92672>router-outlet</span>&gt; <span style=color:#75715e>&lt;!-- 命名插座显示 user-profile --&gt;</span>
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><p>可以在路由链接中指定插座名称：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>routerLink</span><span style=color:#960050;background-color:#1e0010>]=&#34;[{</span> <span style=color:#a6e22e>outlets:</span> <span style=color:#960050;background-color:#1e0010>{</span> <span style=color:#a6e22e>primary:</span> <span style=color:#960050;background-color:#1e0010>[&#39;</span><span style=color:#a6e22e>dashboard</span><span style=color:#960050;background-color:#1e0010>&#39;],</span> <span style=color:#a6e22e>sidebar:</span> <span style=color:#960050;background-color:#1e0010>[&#39;</span><span style=color:#a6e22e>user-profile</span><span style=color:#960050;background-color:#1e0010>&#39;]</span> <span style=color:#960050;background-color:#1e0010>}</span> <span style=color:#960050;background-color:#1e0010>}]&#34;</span>&gt;
</span></span><span style=display:flex><span>   Go to Dashboard and User Profile
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><h1 id=导航路由>导航路由
<a class=anchor href=#%e5%af%bc%e8%88%aa%e8%b7%af%e7%94%b1>#</a></h1><p>在 JS 中通过 <code>Router.navigate</code> 方法跳转路由：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- app.component.html --&gt;</span>
</span></span><span style=display:flex><span> &lt;<span style=color:#f92672>button</span> <span style=color:#960050;background-color:#1e0010>(</span><span style=color:#a6e22e>click</span><span style=color:#960050;background-color:#1e0010>)=&#34;</span><span style=color:#a6e22e>jump</span><span style=color:#960050;background-color:#1e0010>()&#34;</span>&gt;跳转到发展历史&lt;/<span style=color:#f92672>button</span>&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app.component.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Router</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@angular/router&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HomeComponent</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>jump() {</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>navigate</span>([<span style=color:#e6db74>&#34;/about/history&#34;</span>], {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>queryParams</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Kitty&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=路由懒加载>路由懒加载
<a class=anchor href=#%e8%b7%af%e7%94%b1%e6%87%92%e5%8a%a0%e8%bd%bd>#</a></h1><p>Angular 最新的版本推荐使用 Standalone 组件，可以通过 <code>loadComponent</code> 来进行懒加载配置。和常规的模块懒加载不同，Standalone 组件的懒加载是基于组件的，而不是模块。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Routes</span>, <span style=color:#a6e22e>RouterModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loadComponent</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;./dashboard/dashboard.component&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>m</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>DashboardComponent</span>)  <span style=color:#75715e>// 懒加载 Standalone 组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>redirectTo</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/dashboard&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pathMatch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;full&#39;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><blockquote><p>在 Angular 中，Standalone 组件配置了懒加载，其<strong>子组件不会自动成为懒加载组件</strong>。懒加载是基于路由配置的，当你在路由配置中指定某个组件使用 <code>loadComponent</code> 来进行懒加载时，只有<strong>该组件本身</strong>被懒加载。其子组件仍然会像常规组件一样，在加载父组件时一并加载。</p></blockquote><h2 id=路由懒加载的好处>路由懒加载的好处
<a class=anchor href=#%e8%b7%af%e7%94%b1%e6%87%92%e5%8a%a0%e8%bd%bd%e7%9a%84%e5%a5%bd%e5%a4%84>#</a></h2><ul><li>减小初始包体积：只有在用户访问某个路由时，相关的 Standalone 组件才会被加载，这样可以减小应用的初始包体积，提升性能。</li><li>按需加载：用户只加载他们需要的部分，这对于大型应用来说是一个显著的性能优化。</li><li>简单配置：与传统的模块懒加载相比，Standalone 组件的懒加载配置更加简洁，因为不再需要为每个懒加载的组件创建单独的模块。</li></ul><h1 id=路由守卫>路由守卫
<a class=anchor href=#%e8%b7%af%e7%94%b1%e5%ae%88%e5%8d%ab>#</a></h1><p><strong>路由守卫</strong>（Route Guards）用于在用户导航到路由之前、或者离开路由时，控制访问权限或执行某些逻辑。</p><p>路由守卫可以帮助你做很多事情，例如：权限控制、登录验证、数据预加载等。</p><p>常用的路由守卫类型：</p><ul><li><code>CanActivate</code>: 在导航到某个路由时进行检查，控制是否允许该路由激活。</li><li><code>CanDeactivate</code>: 在导航离开当前路由时进行检查，控制是否允许离开该路由（例如，防止丢失未保存的表单数据）。</li><li><code>CanLoad</code>: 在懒加载模块时进行检查，控制是否允许加载该模块。</li><li><code>Resolve</code>: 在路由激活前加载数据，确保数据在路由激活之前就被加载。</li></ul><p>路由可以应用多个守卫，所有守卫方法都允许，路由才被允许访问，有一个守卫方法不允许，则路由不允许被访问。</p><h2 id=canactivate>CanActivate
<a class=anchor href=#canactivate>#</a></h2><p><code>CanActivate</code> 守卫用于控制进入路由时的权限，比如检查用户是否已经登录，或者是否有权限访问某个页面。<code>CanActivate</code> 会在路由激活之前执行。即便是懒加载模块，<code>CanActivate</code> 也会在模块加载之前执行。</p><p>创建路由守卫：<code>ng generate guard auth</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// auth.guard.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanActivate</span>, <span style=color:#a6e22e>ActivatedRouteSnapshot</span>, <span style=color:#a6e22e>RouterStateSnapshot</span>, <span style=color:#a6e22e>Router</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AuthService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./auth.service&#39;</span>;  <span style=color:#75715e>// 假设你有一个 AuthService 用于检查登录状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AuthGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanActivate</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>authService</span>: <span style=color:#66d9ef>AuthService</span>, <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>canActivate</span>(
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>next</span>: <span style=color:#66d9ef>ActivatedRouteSnapshot</span>,
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>state</span>: <span style=color:#66d9ef>RouterStateSnapshot</span>
</span></span><span style=display:flex><span>   )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>authService</span>.<span style=color:#a6e22e>isAuthenticated</span>()) {
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>         <span style=color:#75715e>// 如果未认证，重定向到登录页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>         <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>navigate</span>([<span style=color:#e6db74>&#39;/login&#39;</span>]);
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后，在路由配置中使用该守卫：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app-routing.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NgModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RouterModule</span>, <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AuthGuard</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./auth.guard&#39;</span>;  <span style=color:#75715e>// 引入守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>DashboardComponent</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>canActivate</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>AuthGuard</span>]  <span style=color:#75715e>// 使用守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   },
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;login&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>LoginComponent</span>
</span></span><span style=display:flex><span>   },
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>redirectTo</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/dashboard&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pathMatch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;full&#39;</span>
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><p>当用户尝试访问 <code>/dashboard</code> 路由时，AuthGuard 会先执行，如果用户已经认证（<code>authService.isAuthenticated()</code> 返回 <code>true</code>），则允许导航；否则，导航会被重定向到 <code>/login</code> 页面。</p><h2 id=canactivatechild>CanActivateChild
<a class=anchor href=#canactivatechild>#</a></h2><p><code>CanActivateChild</code> 路由守卫用于控制 子路由 的访问权限。它与 <code>CanActivate</code> 类似，但 <code>CanActivateChild</code> 主要针对的是父路由的<strong>所有子路由</strong>的访问控制。通过使用 <code>CanActivateChild</code>，可以统一管理子路由的权限控制，而不需要在每个子路由上单独配置守卫。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// auth.guard.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanActivateChild</span>, <span style=color:#a6e22e>ActivatedRouteSnapshot</span>, <span style=color:#a6e22e>RouterStateSnapshot</span>, <span style=color:#a6e22e>Router</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AuthService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./auth.service&#39;</span>;  <span style=color:#75715e>// 假设你有一个 AuthService 用于检查用户登录状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AuthGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanActivateChild</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>authService</span>: <span style=color:#66d9ef>AuthService</span>, <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>canActivateChild</span>(
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>next</span>: <span style=color:#66d9ef>ActivatedRouteSnapshot</span>, 
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>state</span>: <span style=color:#66d9ef>RouterStateSnapshot</span>
</span></span><span style=display:flex><span>   )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 判断用户是否已认证
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>authService</span>.<span style=color:#a6e22e>isAuthenticated</span>()) {
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;  <span style=color:#75715e>// 允许访问子路由
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>         <span style=color:#75715e>// 如果未认证，重定向到登录页面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>         <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>navigate</span>([<span style=color:#e6db74>&#39;/login&#39;</span>]);
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;  <span style=color:#75715e>// 拒绝访问
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在路由配置中使用 <code>CanActivateChild</code> 守卫。<code>CanActivateChild</code> 需要被配置在父路由上，而不是每个子路由。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app-routing.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NgModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RouterModule</span>, <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AuthGuard</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./auth.guard&#39;</span>;  <span style=color:#75715e>// 引入守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DashboardComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./dashboard/dashboard.component&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SettingsComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./settings/settings.component&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ProfileComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./profile/profile.component&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>DashboardComponent</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>canActivateChild</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>AuthGuard</span>],  <span style=color:#75715e>// 使用 CanActivateChild 守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>         {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;settings&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>SettingsComponent</span>
</span></span><span style=display:flex><span>         },
</span></span><span style=display:flex><span>         {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;profile&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>ProfileComponent</span>
</span></span><span style=display:flex><span>         }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>   },
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;login&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>LoginComponent</span>
</span></span><span style=display:flex><span>   },
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>redirectTo</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/dashboard&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>pathMatch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;full&#39;</span>
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><h2 id=candeactivate>CanDeactivate
<a class=anchor href=#candeactivate>#</a></h2><p><code>CanDeactivate</code> 守卫用于在离开当前路由时进行检查，通常用于防止用户丢失未保存的表单数据或者在离开当前页面时提示用户。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// can-deactivate.guard.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanDeactivate</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 守卫可以适用于多个组件，通常会创建一个接口来约束组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>CanComponentDeactivate</span> {
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>canDeactivate</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CanDeactivateGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanDeactivate</span>&lt;<span style=color:#f92672>CanComponentDeactivate</span>&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>canDeactivate</span>(
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>CanComponentDeactivate</span>
</span></span><span style=display:flex><span>   )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>canDeactivate</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>canDeactivate</span>() <span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在组件中实现 <code>canDeactivate</code> 方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// form.component.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanComponentDeactivate</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./can-deactivate.guard&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Component</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-form&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./form.component.html&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FormComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanComponentDeactivate</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>formIsDirty</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;  <span style=color:#75715e>// 假设这是表单是否已更改的状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canDeactivate</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>formIsDirty</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> window.<span style=color:#a6e22e>confirm</span>(<span style=color:#e6db74>&#39;You have unsaved changes. Do you really want to leave?&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>配置路由守卫：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app-routing.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NgModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RouterModule</span>, <span style=color:#a6e22e>Routes</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanDeactivateGuard</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./can-deactivate.guard&#39;</span>;  <span style=color:#75715e>// 引入守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>FormComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./form.component&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;form&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>FormComponent</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>canDeactivate</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>CanDeactivateGuard</span>]  <span style=color:#75715e>// 使用守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><h2 id=canload>CanLoad
<a class=anchor href=#canload>#</a></h2><p><code>CanLoad</code> 守卫用于在懒加载模块时进行检查，确保只有在满足某些条件下才允许加载该模块。它通常用于懒加载模块的权限控制。如果用户没有权限或未登录，<code>CanLoad</code> 可以阻止模块加载，避免加载不必要的资源。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// can-load.guard.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CanLoad</span>, <span style=color:#a6e22e>Route</span>, <span style=color:#a6e22e>UrlSegment</span>, <span style=color:#a6e22e>Router</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AuthService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./auth.service&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CanLoadGuard</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>CanLoad</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>authService</span>: <span style=color:#66d9ef>AuthService</span>, <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>canLoad</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>Route</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>segments</span>: <span style=color:#66d9ef>UrlSegment</span>[]
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; <span style=color:#f92672>|</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>authService</span>.<span style=color:#a6e22e>isAuthenticated</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>navigate</span>([<span style=color:#e6db74>&#39;/login&#39;</span>]);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后在懒加载模块的路由配置中使用 <code>CanLoad</code> 守卫：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app-routing.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Routes</span>, <span style=color:#a6e22e>RouterModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;admin&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loadChildren</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;./admin/admin.module&#39;</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>m</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>AdminModule</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>canLoad</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>CanLoadGuard</span>]  <span style=color:#75715e>// 使用 CanLoad 守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><h2 id=resolve>Resolve
<a class=anchor href=#resolve>#</a></h2><p><code>Resolve</code> 守卫用于在路由激活之前预先加载数据，确保组件渲染之前数据已经准备好。</p><p>通常会调用一个服务来获取数据，然后在服务中实现 <code>Resolve</code> 接口：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// data-resolver.service.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Resolve</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Observable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;rxjs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DataService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./data.service&#39;</span>;  <span style=color:#75715e>// 假设有一个服务提供数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Injectable</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DataResolver</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>Resolve</span>&lt;<span style=color:#f92672>any</span>&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>dataService</span>: <span style=color:#66d9ef>DataService</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>resolve</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Observable</span>&lt;<span style=color:#f92672>any</span>&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>dataService</span>.<span style=color:#a6e22e>getData</span>();  <span style=color:#75715e>// 返回需要加载的数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>配置路由时使用 resolve：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// app-routing.module.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Routes</span>, <span style=color:#a6e22e>RouterModule</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DataResolver</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./data-resolver.service&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DashboardComponent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./dashboard/dashboard.component&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>routes</span>: <span style=color:#66d9ef>Routes</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>   {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;dashboard&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>DashboardComponent</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>resolve</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>         <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>DataResolver</span>  <span style=color:#75715e>// 使用 resolve 守卫
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@NgModule</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>imports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>.<span style=color:#a6e22e>forRoot</span>(<span style=color:#a6e22e>routes</span>)],
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>exports</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>RouterModule</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppRoutingModule</span> {}
</span></span></code></pre></div><p>在组件中，通过 <code>ActivatedRoute</code> 来访问预加载的数据：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// dashboard.component.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>OnInit</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ActivatedRoute</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Component</span>({
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-dashboard&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./dashboard.component.html&#39;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DashboardComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>route</span>: <span style=color:#66d9ef>ActivatedRoute</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>ngOnInit</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route</span>.<span style=color:#a6e22e>snapshot</span>.<span style=color:#a6e22e>data</span>[<span style=color:#e6db74>&#39;data&#39;</span>];  <span style=color:#75715e>// 获取 resolve 中的数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=路由事件>路由事件
<a class=anchor href=#%e8%b7%af%e7%94%b1%e4%ba%8b%e4%bb%b6>#</a></h1><p>路由事件 (<code>RouterEvent</code>) 是指与路由相关的各种操作发生时触发的事件。通过监听这些事件，可以执行一些特定的操作，如路由开始时的动画效果、在路由切换时获取日志信息、监控路由生命周期等。</p><p>常用的路由事件：</p><ul><li><code>NavigationStart</code>: 当路由开始导航时触发。</li><li><code>NavigationEnd</code>: 当路由导航完成时触发。</li><li><code>NavigationCancel</code>: 如果导航被取消时触发。</li><li><code>NavigationError</code>: 如果导航出错时触发。</li><li><code>RoutesRecognized</code>: 当路由的目标路径已经解析完毕时触发。</li><li><code>ChildActivationStart</code>: 当子路由激活开始时触发。</li><li><code>ChildActivationEnd</code>: 当子路由激活结束时触发。</li><li><code>ActivationStart</code>: 当路由激活开始时触发。</li><li><code>ActivationEnd</code>: 当路由激活结束时触发。</li><li><code>DeactivationStart</code>: 当路由停用开始时触发。</li><li><code>DeactivationEnd</code>: 当路由停用结束时触发。</li></ul><h2 id=显示加载指示器>显示加载指示器
<a class=anchor href=#%e6%98%be%e7%a4%ba%e5%8a%a0%e8%bd%bd%e6%8c%87%e7%a4%ba%e5%99%a8>#</a></h2><p>如果要实现在导航开始时显示一个加载器，并在导航完成时隐藏它。可以通过订阅 <code>NavigationStart</code> 和 <code>NavigationEnd</code> 事件来实现。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>OnInit</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Router</span>, <span style=color:#a6e22e>NavigationStart</span>, <span style=color:#a6e22e>NavigationEnd</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/router&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>@Component</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-root&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./app.component.html&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>styleUrls</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./app.component.css&#39;</span>]
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppComponent</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>OnInit</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loading</span>: <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>router</span>: <span style=color:#66d9ef>Router</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngOnInit</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>subscribe</span>((<span style=color:#a6e22e>event</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span> <span style=color:#66d9ef>instanceof</span> <span style=color:#a6e22e>NavigationStart</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>loading</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;  <span style=color:#75715e>// 显示加载指示器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span> <span style=color:#66d9ef>instanceof</span> <span style=color:#a6e22e>NavigationEnd</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>loading</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;  <span style=color:#75715e>// 隐藏加载指示器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/commit/ec85cf9388ebb2878f63a5754d61076147d90f6b title='Last modified by shipengqi | December 8, 2024' target=_blank rel=noopener><img src=/frontend-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 8, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/frontend-learn/edit/master/content/docs/angular/11_router.md target=_blank rel=noopener><img src=/frontend-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#快速上手>快速上手</a></li><li><a href=#路由规则>路由规则</a><ul><li><a href=#重定向>重定向</a></li><li><a href=#404-页面>404 页面</a></li></ul></li><li><a href=#路由传参>路由传参</a><ul><li><a href=#查询参数>查询参数</a></li><li><a href=#动态参数>动态参数</a></li><li><a href=#配置路由数据>配置路由数据</a></li><li><a href=#snapshot>snapshot</a></li></ul></li><li><a href=#路由嵌套>路由嵌套</a></li><li><a href=#命名插座>命名插座</a></li><li><a href=#导航路由>导航路由</a></li><li><a href=#路由懒加载>路由懒加载</a><ul><li><a href=#路由懒加载的好处>路由懒加载的好处</a></li></ul></li><li><a href=#路由守卫>路由守卫</a><ul><li><a href=#canactivate>CanActivate</a></li><li><a href=#canactivatechild>CanActivateChild</a></li><li><a href=#candeactivate>CanDeactivate</a></li><li><a href=#canload>CanLoad</a></li><li><a href=#resolve>Resolve</a></li></ul></li><li><a href=#路由事件>路由事件</a><ul><li><a href=#显示加载指示器>显示加载指示器</a></li></ul></li></ul></nav></div></aside></main></body></html>